<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Rethinking exceptions - Neil Fenwick | .NET, Go and Software Engineering</title><meta name=Description content="Checked, unchecked or just unwanted? How we can look differently at error handling in C#"><meta property="og:title" content="Rethinking exceptions">
<meta property="og:description" content="Checked, unchecked or just unwanted? How we can look differently at error handling in C#"><meta property="og:type" content="article"><meta property="og:url" content="https://neilfenwick.net/posts/rethinking-exceptions/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-04T23:52:00+00:00"><meta property="article:modified_time" content="2025-02-04T23:52:00+00:00"><meta property="og:site_name" content="Neil Fenwick | .NET, Go and Software Engineering"><meta name=twitter:card content="summary"><meta name=twitter:title content="Rethinking exceptions"><meta name=twitter:description content="Checked, unchecked or just unwanted? How we can look differently at error handling in C#"><meta name=application-name content="N Fenwick"><meta name=apple-mobile-web-app-title content="N Fenwick"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><meta http-equiv=Content-Security-Policy content="
  default-src 'self';
  script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com;
  style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com;
  img-src 'self' data:;
  font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net;
  connect-src 'self';
  object-src 'none';
  base-uri 'self';
  form-action 'self';
"><link rel=preconnect href=https://cdn.jsdelivr.net><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://neilfenwick.net/posts/rethinking-exceptions/><link rel=prev href=https://neilfenwick.net/posts/dev-containers/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><link rel=preload href=/css/syntax.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/css/syntax.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Rethinking exceptions","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/neilfenwick.net\/posts\/rethinking-exceptions\/"},"genre":"posts","keywords":"c-sharp, go","wordcount":2425,"url":"https:\/\/neilfenwick.net\/posts\/rethinking-exceptions\/","datePublished":"2025-02-04T23:52:00+00:00","dateModified":"2025-02-04T23:52:00+00:00","license":"© {year}","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Neil Fenwick"},"description":"Checked, unchecked or just unwanted? How we can look differently at error handling in C#"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"light"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"light"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Neil Fenwick | .NET, Go and Software Engineering"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/logo.webp data-srcset="/logo.webp, /logo.webp 1.5x, /logo.webp 2x" data-sizes=auto alt=/logo.webp title=/logo.webp width=108 height=108></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Neil Fenwick | .NET, Go and Software Engineering"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/logo.webp data-srcset="/logo.webp, /logo.webp 1.5x, /logo.webp 2x" data-sizes=auto alt=/logo.webp title=/logo.webp width=108 height=108></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Rethinking exceptions</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://bsky.app/profile/neil-fenwick.bsky.social title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Neil Fenwick</a></span>&nbsp;<span class=post-category>in <a href=/categories/programming/><i class="far fa-folder fa-fw" aria-hidden=true></i>Programming</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime="February 4, 2025">February 4, 2025</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2425 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;12 minutes&nbsp;</div></div><div class=content id=content><p>Why do newer programming languages like Go, Rust and Zig eschew <strong>Exceptions</strong>, believing that they cause
<strong>unpredictable control flow and hidden performance costs</strong>? Instead they encourage explicit error tracking. Even Kotlin
prefers a more functional style of error handling over unchecked exceptions.</p><p>Whether you&rsquo;ve been working with C# for just a few months, or for several years, have you ever stopped to consider the
way that you write code to handle errors? How do other languages deal with errors and why did they choose the approach
that they did? Let&rsquo;s explore a few and, just maybe, it might change the way that you write and think about your C# code.</p><h2 id=what-is-an-exception-really>What is an exception, really?</h2><p>The typical way that languages think about an <code>Exception</code> is as a data structure that holds information about an error
condition. Instead of being returned like a regular value, the exception is <em>thrown</em>, meaning that execution of the
current code path is interrupted, and control is transferred to an appropriate error-handling mechanism, like a <code>catch</code>
block.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cs data-lang=cs><span class=line><span class=cl><span class=kt>uint</span> <span class=n>ParseInput</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>number</span> <span class=p>=</span> <span class=kt>int</span><span class=p>.</span><span class=n>Parse</span><span class=p>(</span><span class=n>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>number</span> <span class=p>&lt;</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentOutOfRangeException</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>paramName</span><span class=p>:</span> <span class=n>nameof</span><span class=p>(</span><span class=n>text</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>message</span><span class=p>:</span> <span class=s>&#34;Value cannot be negative.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=kt>uint</span><span class=p>)</span><span class=n>number</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span> <span class=p>(</span><span class=n>FormatException</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentException</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>message</span><span class=p>:</span> <span class=s>&#34;Invalid input. Must be a number.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>paramName</span><span class=p>:</span> <span class=n>nameof</span><span class=p>(</span><span class=n>text</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class="details admonition info"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>Side note: Why the Exception parameters appear reversed above<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>In the example above,
notice that the &ldquo;paramName&rdquo; argument comes first in <code>ArgumentOutOfRangeException</code>, but second in <code>ArgumentException</code>.
This may seem inconsistent at first, but
<a href="https://learn.microsoft.com/en-us/dotnet/api/system.argumentoutofrangeexception.-ctor?view=net-9.0#overloads" target=_blank rel="noopener noreffer">each constructor overload maintains a consistent order across its other variations</a>
— ensuring that the single-argument constructor always aligns. So in that sense, it <em>is</em> consistent.</div></div></div><p>If our code above was published as a library, the caller&rsquo;s code will compile just fine if they call the code above
outside of a try / catch block&mldr; <strong>so, how does the caller know that they might need to handle the exceptions that are
being thrown?</strong> (For now, let&rsquo;s ignore that you <em>should</em> document the exceptions in the method&rsquo;s xml-doc comments, and
that the caller would <em>definitely</em> &#x1f609; read it&mldr;)</p><p>Before we answer that, let&rsquo;s take a brief look at the state of the world when C# was being designed, to better
understand where it came from and what it still needs to support today. C# has been around for about two decades, and
throughout that time, the Microsoft team has worked hard to ensure that existing code has continued to compile as .NET
has evolved. You can still compile most C# code from the early 2000s today.</p><h2 id=why-did-c-adopt-exceptions-as-a-language-feature>Why did C# adopt Exceptions as a language feature?</h2><p>When C# was being designed in the late 1990s, Java was one of the most prominent object-oriented languages, especially
in enterprise development. Microsoft sought to create a language that felt familiar to enterprise developers, <a href=https://web.archive.org/web/20100109195800/http://windowsdevcenter.com/pub/a/oreilly/windows/news/hejlsberg_0800.html target=_blank rel="noopener noreffer">making C#
syntax and core features resemble features from languages like Java, C++, C, Smalltalk, and others</a>.</p><p>They made one significantly different choice to Java when it came to Exceptions though. C# implemented <em>unchecked
exceptions</em> (you can catch exceptions, but you don&rsquo;t have to explicitly handle them or declare them on method
signatures), whereas Java has <em>checked exceptions</em>. If you haven&rsquo;t come across the idea of <em>checked exceptions</em> before,
this is what they look like:</p><p>In Java, you <strong>must</strong> either catch the exceptions that are declared by the code that you call:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>processInputData</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>text</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>readInputFile</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>text</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>IOException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// handle exception</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Or, you must re-declare the same exception on your own method to let it bubble up the call stack:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>processInputData</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>IOException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>text</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>readInputFile</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>text</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>This shows how Java explicitly signals to the caller that a method might throw an exception - unlike C#. The compiler
<em>makes you deal with them explicitly</em>.</p><p>The above example is fairly simple. But in larger codebases, one obvious consequence of checked exceptions is the amount
of code churn that they create. Imagine you are consuming a third party library, and then that library introduces a new
type of Exception that it declares is thrown in one of the methods that you are already calling. Well, that is now a
compiler error for your code unless you catch and handle it. If you can’t handle it at the call site, you must rethrow
or redeclare it - causing a chain reaction of compiler errors until the exception is finally caught or suppressed.</p><h3 id=why-c-chose-to-do-it-differently-from-java>Why C# chose to do it differently from Java</h3><p>In a <a href=https://www.artima.com/articles/the-trouble-with-checked-exceptions target=_blank rel="noopener noreffer">2003 interview titled &ldquo;The Trouble with Checked Exceptions,&rdquo;</a> Anders Hejlsberg, the lead architect of C#,
discussed the rationale behind C#&rsquo;s approach to exception handling. He highlighted concerns regarding versioning and
scalability associated with checked exceptions, which influenced the decision to exclude them from C#.</p><p>The broader debate between checked and unchecked exceptions tends to cover these key points (among others):</p><ul><li><p>Error Handling Complexity: <strong>Checked exceptions can lead to cluttered code</strong>, as developers must catch or declare
them, even when meaningful recovery actions are not possible.</p></li><li><p>API Design Philosophy: <strong>Unchecked exceptions allow for cleaner APIs</strong> by not enforcing exception handling at every
level, thereby promoting a more streamlined and readable codebase.</p></li><li><p>Developer Responsibility: <strong>Unchecked exceptions place the onus on developers to handle exceptions appropriately</strong>,
offering flexibility to manage errors where it makes the most sense in the application flow.</p></li></ul><h2 id=other-options-that-c-could-have-considered>Other options that C# could have considered?</h2><p>Back to those modern languages that I mentioned&mldr; the new languages that have chosen a different approach to error
handling.</p><p>Here&rsquo;s how that previous code might look in Go:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>processInputData</span><span class=p>()</span> <span class=p>(</span><span class=kt>string</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>text</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>readInputFile</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Return an empty string and wrap the error
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;failed to process input: %w&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>text</span><span class=p>,</span> <span class=kc>nil</span> <span class=c1>// Success
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><p>In Go, functions have multiple return values, and by convention errors are returned as the last return value. Errors in
Go are &ldquo;just data&rdquo; (remember that I wrote earlier that Exceptions are just &ldquo;a data structure that holds information
about an error condition&rdquo;?) - so errors and exceptions are fundamentally just error <em>data</em>. <strong>What is different between
errors and exceptions is in how they are propagated</strong>. When you call a function in Go, you don&rsquo;t know if the return
value is useful or just an empty value, until you check to see if an error has been returned or not.</p><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>Go programmer bugbear: if err != nil<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Probably the most frequent complaint from Go
programmers is about how often they need to type <code>if err != nil</code> because so many functions return an error value. It
becomes tedious boilerplate, but if any kind of tedium could be called a good thing, this is good because it makes
programmers deal with an error as soon as possible. It is explicit. No surprises!</div></div></div><p>The biggest difference when comparing Go&rsquo;s &ldquo;error as a value&rdquo; pattern with C# exceptions is that there is <strong>no hidden
control flow</strong>. If an error occurs in Go, the function that you just called <em>still returns</em> and then you just check what
you got back. As the caller, you are still in full control and can decide what to call next, depending on whether you
received an error or not.</p><p>Because the function declares the error in its function signature, you are fully aware that an error could possibly be
returned:</p><pre tabindex=0><code>func processInputData() (string, error)
</code></pre><p>Checking the error immediately causes you to consider how to deal with it as close to where it occurred as possible, in
most cases, literally on the next line of code!</p><pre tabindex=0><code>text, err := readInputFile()
if err != nil {
    return &#34;&#34;, fmt.Errorf(&#34;failed to process input: %w&#34;, err)
}
</code></pre><p>Languages that throw exceptions have multiple control flow paths - and this adds to cognitive load. Your happy-path code
flows down one set of method calls, but if an exception is thrown, that flows back up a different route, through a
series of catch blocks. The catch block in any given method might be many lines away from the line of code that caused
the exception that is being handled in the catch block! In Go, you would typically handle the error condition
immediately next to the code that gives rise to the error condition.</p><table><thead><tr><th>Feature</th><th>C# (Exceptions)</th><th>Go (Error as a Value)</th></tr></thead><tbody><tr><td><strong>Error Propagation</strong></td><td>Implicit (stack unwinding)</td><td>Explicit (<code>if err != nil</code>)</td></tr><tr><td><strong>Control Flow</strong></td><td>Multiple paths (<code>try/catch</code>)</td><td>Linear (error is returned)</td></tr><tr><td><strong>Performance</strong></td><td>Overhead from exception handling</td><td>No performance penalty</td></tr><tr><td><strong>Readability</strong></td><td>Errors handled far from source</td><td>Errors handled at the call site</td></tr></tbody></table><h2 id=exceptional-or-just-errors>&ldquo;exceptional&rdquo; or just errors?</h2><p>From my experience, most of the exceptions that we throw within application code in C# are actually just conveying error
information. They aren&rsquo;t &ldquo;exceptional&rdquo; cases such as OutOfMemoryException which would be a true, unforeseen, error that
cannot be recovered - in other words, <em>exceptional</em>.</p><p>If we look at a sample of C# exceptions from three main categories, it starts to appear that there are some kinds of
exception that can be anticipated, and therefore might be treated as errors that could be <em>returned</em> instead of
<em>thrown</em>.</p><h3 id=1-application-exceptions-common-anticipated-assertion-and-logic-errors>1. Application Exceptions (common anticipated assertion and logic errors)</h3><ul><li>Exception (<code>System.Exception</code>)<ul><li>IOException (<code>System.IO.IOException</code>)</li><li>TimeoutException (<code>System.TimeoutException</code>)</li><li>FileNotFoundException (<code>System.IO.FileNotFoundException</code>)</li><li>UnauthorizedAccessException (<code>System.UnauthorizedAccessException</code>)</li><li>InvalidOperationException (<code>System.InvalidOperationException</code>)</li><li>CustomException (User-defined)</li></ul></li></ul><p><strong>Application Exceptions</strong> can be anticipated during programming because they <strong>indicate logical error conditions, or
assertions</strong>. (Not to be confused with the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.applicationexception?view=net-9.0#remarks" target=_blank rel="noopener noreffer">System.ApplicationException class that should not be used</a>.)</p><p>It is frustrating to me that the general advice is to derive custom exceptions from <code>System.Exception</code>, because that
base class is also shared with <code>System.SystemException</code>. I think the original intention was for all application
exceptions to derive from <code>System.ApplicationException</code> but inconsistencies in the framework led to that being
impractical. So create your own base class and derive your custom exceptions from that instead.</p><div class="details admonition success open"><div class="details-summary admonition-title"><i class="icon fas fa-check-circle fa-fw" aria-hidden=true></i>DO: derive a custom exception base class from `System.Exception`<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Custom exceptions
should be derived from the <code>System.Exception</code> class to differentiate them from other kinds of unanticipated runtime
errors derived from <code>System.SystemException</code>.</div></div></div><p>These types of exceptions are the ones that you might throw from a constructor in your core business logic domain. (C#
cannot return values from a constructor, so there is no way to follow the error-return pattern). If you really wanted to
avoid throwing these kinds of exceptions from a constructor, and have something more like Go&rsquo;s &ldquo;error as a value&rdquo;
approach, then one option is to make private / internal constructors and use a factory method to construct the core
domain entity instead. The factory method could contain the validation rules and invariants and return error values
instead of throwing an exception.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cs data-lang=cs><span class=line><span class=cl><span class=k>using</span> <span class=nn>System</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>ErrorOr</span><span class=p>;</span> <span class=c1>// Assumes ErrorOr or similar library, or custom Result&lt;T&gt; type</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>BankAccount</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>AccountNumber</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>decimal</span> <span class=n>Balance</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=kd>private</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>BankAccount</span><span class=p>(</span><span class=kt>int</span> <span class=n>accountNumber</span><span class=p>,</span> <span class=kt>decimal</span> <span class=n>balance</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>AccountNumber</span> <span class=p>=</span> <span class=n>accountNumber</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Balance</span> <span class=p>=</span> <span class=n>balance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>ErrorOr</span><span class=p>&lt;</span><span class=n>BankAccount</span><span class=p>&gt;</span> <span class=n>Create</span><span class=p>(</span><span class=kt>int</span> <span class=n>accountNumber</span><span class=p>,</span> <span class=kt>decimal</span> <span class=n>initialDeposit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>accountNumber</span> <span class=p>&lt;=</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Error</span><span class=p>.</span><span class=n>Validation</span><span class=p>(</span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;InvalidAccountNumber&#34;</span><span class=p>,</span> <span class=s>&#34;Account number must be positive.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>initialDeposit</span> <span class=p>&lt;</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Error</span><span class=p>.</span><span class=n>Validation</span><span class=p>(</span><span class=s>&#34;NegativeInitialDeposit&#34;</span><span class=p>,</span> <span class=s>&#34;Initial deposit cannot be negative.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>BankAccount</span><span class=p>(</span><span class=n>accountNumber</span><span class=p>,</span> <span class=n>initialDeposit</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>ErrorOr</span><span class=p>&lt;</span><span class=n>Success</span><span class=p>&gt;</span> <span class=n>Withdraw</span><span class=p>(</span><span class=kt>decimal</span> <span class=n>amount</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>amount</span> <span class=p>&lt;=</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Error</span><span class=p>.</span><span class=n>Validation</span><span class=p>(</span><span class=s>&#34;InvalidWithdrawal&#34;</span><span class=p>,</span> <span class=s>&#34;Withdrawal amount must be positive.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>Balance</span> <span class=p>-</span> <span class=n>amount</span> <span class=p>&lt;</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Error</span><span class=p>.</span><span class=n>Validation</span><span class=p>(</span><span class=s>&#34;InsufficientFunds&#34;</span><span class=p>,</span> <span class=s>&#34;Insufficient balance for withdrawal.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>Balance</span> <span class=p>-=</span> <span class=n>amount</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=n>Success</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The example is fairly simple, but focus more on the error vs exception approach. If you really want to avoid using a
third party library in the domain code, <a href=https://github.com/dotnet/csharplang/blob/main/proposals/TypeUnions.md target=_blank rel="noopener noreffer">C# may soon get its own Type Union feature</a> and then you can use
built-in language features to accomplish the same.</p><h3 id=2-runtime-exceptions-commonly-encountered>2. Runtime Exceptions (commonly encountered)</h3><ul><li>SystemException (<code>System.SystemException</code>)<ul><li>NullReferenceException (<code>System.NullReferenceException</code>)</li><li>IndexOutOfRangeException (<code>System.IndexOutOfRangeException</code>)</li><li>ArithmeticException (<code>System.ArithmeticException</code>)<ul><li>DivideByZeroException (<code>System.DivideByZeroException</code>)</li><li>OverflowException (<code>System.OverflowException</code>)</li></ul></li><li>ArgumentException (<code>System.ArgumentException</code>)<ul><li>ArgumentNullException (<code>System.ArgumentNullException</code>)</li><li>ArgumentOutOfRangeException (<code>System.ArgumentOutOfRangeException</code>)</li></ul></li><li>InvalidCastException (<code>System.InvalidCastException</code>)</li><li>FormatException (<code>System.FormatException</code>)</li><li>KeyNotFoundException (<code>System.Collections.Generic.KeyNotFoundException</code>)</li></ul></li></ul><p><strong>Runtime Exceptions</strong> are lower-level error conditions that indicate that the program logic has got into an invalid
state and this would generally be unintentional, and therefore unanticipated. To give you a sense of how seriously we
should treat these kinds of exceptions&mldr;</p><p>&mldr; in Go, the runtime will <code>panic</code> for these kinds problems. A <code>panic</code> will abort the current processing and unwind the
stack, eventually crashing the entire process, unless it is <a href=https://gobyexample.com/recover target=_blank rel="noopener noreffer">recovered to prevent the crash</a>. These types of
errors come as close to exception-like behaviour in Go as it gets, because unwinding the stack after a <code>panic</code> sounds a
lot like the way exceptions work. But the difference is that <strong>in Go, this is <em>not normal</em></strong>. It is <em>exceptional</em> in the
true sense of the word. If only it were the same in C#!</p><div class="details admonition danger open"><div class="details-summary admonition-title"><i class="icon fas fa-skull-crossbones fa-fw" aria-hidden=true></i>Be careful with all types of SystemException<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>Fail as fast and gracefully as possible.
You cannot recover the current state. You might temporarily catch the exception to clean up some resources but then you
should rethrow it.</p><p>The documentation for <code>SystemException</code> says you should <strong>never throw a <code>SystemException</code> in your own code</strong>. Nor should
you attempt to handle a <code>SystemException</code>, other than to briefly release resources, before rethrowing.</p></div></div></div><h3 id=3-unrecoverable-exceptions-less-common-and-usually-fatal>3. Unrecoverable Exceptions (less common and usually fatal)</h3><ul><li>SystemException (<code>System.SystemException</code>)<ul><li>StackOverflowException (<code>System.StackOverflowException</code>)</li><li>OutOfMemoryException (<code>System.OutOfMemoryException</code>)</li><li>AccessViolationException (<code>System.AccessViolationException</code>)</li><li>ThreadAbortException (<code>System.Threading.ThreadAbortException</code>)</li></ul></li></ul><p>A subset of <code>SystemException</code> but with potentially wider implications than just the current operation. For example, the
process might survive a <code>DivideByZeroException</code> if caught, but a <code>StackOverflowException</code> should immediately terminate
the entire process. Whilst you might theoretically catch an <code>OutOfMemoryException</code>, how sure can you be about the
stability and future state of the rest of the process?</p><div class="details admonition danger open"><div class="details-summary admonition-title"><i class="icon fas fa-skull-crossbones fa-fw" aria-hidden=true></i>Some SystemExceptions cannot be recovered<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Some types of <code>SystemException</code> indicate that
the runtime may have got into an invalid or unrecoverable state. Be wary of attempting to proceed because the process or
memory could be in a corrupt or invalid state, making things unpredictable and inconsistent. <strong>This is a situation where
I would consider panicking and terminating the entire program.</strong></div></div></div><h2 id=conclusion>Conclusion</h2><p>We’ve explored that exceptions in C# help to declutter code but come with trade-offs like hidden control flow, runtime
performance costs, and implicit error propagation. This is why modern languages like Go have opted for explicit error
handling instead.</p><p>Maybe C# more programmers will start to change their approach to error handling and start:</p><ul><li>Using error-return patterns (e.g., <code>Result&lt;T></code> in domain logic).</li><li>Avoiding exceptions for expected conditions (e.g., validation errors).</li><li>Keeping exceptions truly exceptional (e.g., SystemException).</li></ul><p>Learning another language like Go can challenge our assumptions and make us write better, simpler code - even in C#.</p><p>What do you think? Would you prefer explicit errors over exceptions in future versions of C#? Maybe C#&rsquo;s Type Unions
will take us quite a lot of the way there&mldr;</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on February 4, 2025</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://neilfenwick.net/posts/rethinking-exceptions/ data-title="Rethinking exceptions" data-hashtags=c-sharp,go><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://neilfenwick.net/posts/rethinking-exceptions/ data-hashtag=c-sharp><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://neilfenwick.net/posts/rethinking-exceptions/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://neilfenwick.net/posts/rethinking-exceptions/ data-title="Rethinking exceptions"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://neilfenwick.net/posts/rethinking-exceptions/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/c-sharp/>C-Sharp</a>,&nbsp;<a href=/tags/go/>Go</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/dev-containers/ class=prev rel=prev title="Dev Containers: The Best Dev Setup You’re Not Using"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Dev Containers: The Best Dev Setup You’re Not Using</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Opinions are my own, not my employer’s. All rights reserved. No liability for use of content, code, or external links.</div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://bsky.app/profile/neil-fenwick.bsky.social target=_blank>Neil Fenwick</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js defer></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:-1},comment:{}}</script><script type=text/javascript src=/js/theme.min.js defer></script></body></html>